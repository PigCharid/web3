<html lang="">

<head>
    <meta charset="utf-8">
    <script src="./ethers-5.2.umd.min.js"type="application/javascript"></script>
    <script type="application/javascript">
        async function metamaskConnect(){
            //判断页面是否安装Metamask
            if (typeof window.ethereum !== 'undefined') {
                console.log("metamask已经安装");
                
                // 新建一个provider
                const provider = new ethers.providers.Web3Provider(window.ethereum)

                // 和metamask请求链接账户
                await provider.send("eth_requestAccounts", []);

                // 持有metamask账户的私钥，并可以签名
                const signer = provider.getSigner()
                // Send 1 ether to an ens name.
    const tx = signer.sendTransaction({
        to: "ricmoo.firefly.eth",
        value: ethers.utils.parseEther("1.0")
    });
                
                
            } else {
            console.log('没有metamask')
            }
        }



       
        // 通过JsonRpc的URL来创建provider
        // If you don't specify a //url//, Ethers connects to the default 
        // (i.e. ``http:/\/localhost:8545``)
        const provider = new ethers.providers.JsonRpcProvider("https://robin.rangersprotocol.com/api/jsonrpc");

        // The provider also allows signing transactions to
        // send ether and pay to change state within the blockchain.
        // For this, we need the account signer...
        const signer = provider.getSigner()

        
        // 获得了provider以后就能去查询链上的信息了  比如查询地址的余额啊 啥的
        // // Look up the current block number
        // await provider.getBlockNumber()
        // // 14983200

        // // Get the balance of an account (by address or ENS name, if supported by network)
        // balance = await provider.getBalance("ethers.eth")
        // // { BigNumber: "182826475815887608" }

        // // Often you need to format the output to something more user-friendly,
        // // such as in ether (instead of wei)
        // ethers.utils.formatEther(balance)
        // // '0.182826475815887608'

        // // If a user enters a string in an input field, you may need
        // // to convert it from ether (as a string) to wei (as a BigNumber)
        // ethers.utils.parseEther("1.0")
        // // { BigNumber: "1000000000000000000" }
        
        

       


        

    </script>
</head>

<body>
    <div>
        <button onclick="metamaskConnect()">链接钱包</button>
    </div>
    <div>
        <button onclick="getName()">查看代币名称</button>
    </div>
    <div>
        <button onclick="getSymbol()">查看代币符号</button>
    </div>
    <div>
        <button onclick="getDecimals()">查看代币精度</button>
    </div>
    <div>
        <button onclick="getTotalSupply()">查看代币总发行量</button>
    </div>
    <div>
        <input id="add" type="text">
        <button onclick="getBalance()">显示当前账户的PPPP余额</button>
    </div>
    <div>
        转账地址：<input id="transfer_to" type="text" >
        转账金额：<input id="transfer_value" type="text">
        <button onclick="transfer()">发起交易</button>
    </div>
    <div>
        授权地址：<input id="approve_to" type="text" >
        授权金额：<input id="approve_value" type="text">
        <button onclick="approve()">确认授权</button>
    </div>
    <div>
        授权人：<input id="allowance_owner" type="text" >
        被授权人：<input id="allowance_spender" type="text">
        <button onclick="getAllowance()">查看授权数量</button>
    </div>
    <div>
        授权地址：<input id="incapprove_to" type="text" >
        追加授权金额：<input id="incapprove_value" type="text">
        <button onclick="incapprove()">确认追加授权</button>
    </div>
    <div>
        授权地址：<input id="decapprove_to" type="text" >
        追加授权金额：<input id="decapprove_value" type="text">
        <button onclick="decapprove()">确认减少授权</button>
    </div>
    <div>
        From:<input id="transferFrom_from" type="text" >
        To:<input id="transferFrom_to" type="text">
        Value:<input id="transferFrom_value" type="text">
        <button onclick="transferFrom()">发起交易</button>
    </div>

    
</body>

</html>